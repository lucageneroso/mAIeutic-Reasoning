{"task_id": "BigCodeBench/65", "prompt": "You are given a list of elements. Each element is a list with the same length as COLUMNS, representing one row a dataframe df to create. Draw a line chart with unique values in the COLUMNS[-1] of the pandas DataFrame \"df\", grouped by the rest of the columns. - The x-label should be set to the string obtained by joining all the column names (except the last one) by the character \"-\". - The y-label should be set to the last column name.\nThe function should output with:\ntuple: A tuple containing:\npandas.DataFrame: The DataFrame of the analyzed data.\nplt.Axes: The Axes object of the plotted line chart.\nYou should write self-contained code starting with:\n```\nimport pandas as pd\nimport matplotlib.pyplot as plt\nCOLUMNS = ['col1', 'col2', 'col3']\ndef task_func(data):\n```", "solution": "import pandas as pd\nimport matplotlib.pyplot as plt\nCOLUMNS = ['col1', 'col2', 'col3']\ndef task_func(data):\n    # Creo il DataFrame\n    df = pd.DataFrame(data, columns=COLUMNS)\n    \n    # Colonne per il raggruppamento: tutte tranne l'ultima\n    group_cols = COLUMNS[:-1]\n    last_col = COLUMNS[-1]\n    \n    # Raggruppo per le colonne meno l'ultima, prendo media dell'ultima colonna\n    grouped = df.groupby(group_cols)[last_col].mean().reset_index()\n    \n    # Creo l'etichetta sull'asse x unendo i valori di ogni riga delle colonne di group_cols con '-'\n    # Si ottiene una lista di stringhe da usare come asse x\n    grouped['x_label'] = grouped[group_cols].astype(str).agg('-'.join, axis=1)\n    \n    # Grafico\n    fig, ax = plt.subplots()\n    ax.plot(grouped['x_label'], grouped[last_col], marker='o')\n    ax.set_xlabel('-'.join(group_cols))\n    ax.set_ylabel(last_col)\n    ax.set_xticklabels(grouped['x_label'], rotation=45, ha='right')\n    plt.tight_layout()\n    \n    return df, ax\n", "entry_point": "task_func"}
