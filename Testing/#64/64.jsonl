{"task_id": "BigCodeBench/64", "prompt": "You are given a list of elements. Each element is a list with the same length as COLUMNS, representing one row a dataframe df to create. Visualize the distribution of different values in a column \"col3\" of a pandas DataFrame df, grouped by \"col1\" and \"col2,\" using a heatmap.\nThe function should output with:\ntuple:\npandas.DataFrame: The DataFrame of the analyzed data.\nplt.Axes: The heatmap visualization.\nYou should write self-contained code starting with:\n```\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n# Constants\nCOLUMNS = ['col1', 'col2', 'col3']\ndef task_func(data):", "solution": "def task_func(data):\n    \"\"\"\n    data: list of elements, each element is a list with length == len(COLUMNS)\n    Returns:\n        tuple:\n            pd.DataFrame: aggregated count DataFrame with MultiIndex (col1, col2) and columns for col3 values\n            plt.Axes: heatmap of the value distribution counts\n    \"\"\"\n    # 1. Creo il DataFrame di partenza\n    df = pd.DataFrame(data, columns=COLUMNS)\n\n    # 2. Calcolo la tabella pivot con le occorrenze di ciascun valore di col3 per (col1, col2)\n    pivot_table = pd.pivot_table(\n        df,\n        index=['col1', 'col2'],\n        columns='col3',\n        aggfunc='size',\n        fill_value=0\n    )\n    \n    # 3. Creo la heatmap\n    fig, ax = plt.subplots(figsize=(10, 8))\n    sns.heatmap(pivot_table, ax=ax, annot=True, fmt='d', cmap='viridis')\n\n    # 4. Ritorno la tabella pivot e l'asse della figura\n    return pivot_table, ax"}
